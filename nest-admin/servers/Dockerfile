FROM node:22.3.0 as builder

CMD [ "mkdir", "/upload" ]

WORKDIR /servers

COPY . .

ENV TZ=Asia/Shanghai

# è®¾ç½® node é˜¿é‡Œé•œåƒ
RUN npm config set registry https://registry.npmmirror.com
# è®¾ç½®--max-old-space-size
ENV NODE_OPTIONS=--max-old-space-size=16384
# è®¾ç½®é˜¿é‡Œé•œåƒã€pnpmã€ä¾èµ–ã€ç¼–è¯‘
RUN npm install pnpm -g && \
    pnpm install --no-frozen-lockfile && \
    pnpm build
# nodeéƒ¨åˆ†ç»“æŸ
RUN echo "ğŸ‰ ç¼– ğŸ‰ è¯‘ ğŸ‰ æˆ ğŸ‰ åŠŸ ğŸ‰"

EXPOSE 5173
